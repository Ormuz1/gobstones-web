<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-spoiler/paper-spoiler.html">

<dom-module id="activity-settings">
  <style>
    .container {
      display: flex;
      gap: 30px;
    }

    .choice {
      border: 1px solid #c8c7c7;
      border-radius: 5px;
      padding: 0 10px;
      /* height: 350px; */
      cursor: pointer;
      transition: 0.2s cubic-bezier(0.3, 0, 0.5, 1);
      transition-property: color, background-color, border-color, height;
    }

    .choice:hover {
      background-color: #e9f3ff;
      transition-duration: 0.1s;
    }
  </style>

  <template>
    <h1>
      ¡Te damos la bienvenida a Gobstones Teacher!
      <paper-icon-button dialog-confirm suffix icon="folder-open" on-click="loadFromFile"></paper-icon-button>
    </h1>

    <h3>¿Qué tipo de proyecto querés crear?</h3>

    <div class="container">
      <div class="choice">
        <a dialog-confirm on-tap="notifySettingsBlocks">
          <h3>{{ allConstructionModes.blocks.name }}</h3>
          <img width="250" src="../../images/activity/{{allConstructionModes.blocks.id}}-{{executionType.id}}.png" />
        </a>
      </div>
      <div class="choice">
        <a dialog-confirm on-tap="notifySettingsText">
          <h3>{{ allConstructionModes.text.name }}</h3>
          <img width="250" src="../../images/activity/{{allConstructionModes.text.id}}-{{executionType.id}}.png" />
        </a>
      </div>
    </div>

    <div style="margin-top: 10px;">
      <paper-spoiler title="Otras opciones">
        <paper-item style="padding: 0;">
          <paper-item-body three-line>
            <div>Modalidad de ejecución</div>
            <div secondary>Para hacer un juego o simulación, elegí interactivo.</div>
          </paper-item-body>
          <paper-dropdown-menu>
            <paper-listbox class="dropdown-content" selected="{{ executionTypeIndex }}">
              <template is="dom-repeat" items="{{ allExecutionTypes }}">
                <paper-item>{{item.name}}</paper-item>
              </template>
            </paper-listbox>
          </paper-dropdown-menu>
        </paper-item>
      </paper-spoiler>
    </div>
  </template>

  <script>
    const CONSTRUCTION_MODES = {
      blocks: { id: 'blocks', name: 'Bloques' },
      text: { id: 'text', name: 'Texto' },
    };

    const EXECUTION_TYPES = [
      {
        id: 'sequential',
        name: 'Secuencial',
      },
      {
        id: 'interactive',
        name: 'Interactiva',
      }
    ];

    Polymer({
      is: "activity-settings",
      properties: {
        executionTypeIndex: {
          type: Number,
          value: 0
        },
        executionType: {
          type: Object,
          computed: "_computeSelectedItem(allExecutionTypes, executionTypeIndex)"
        },
        allExecutionTypes: {
          type: Array,
          value: EXECUTION_TYPES
        },
        allConstructionModes: {
          type: Object,
          value: CONSTRUCTION_MODES
        }
      },

      loadFromFile: function() {
        window.BUS.fire("load-project-from-file");
      },

      notifySettingsBlocks() {
        this.fire('activity-settings-update', { constructionMode: CONSTRUCTION_MODES.blocks, executionType: this.executionType })
      },

      notifySettingsText() {
        this.fire('activity-settings-update', { constructionMode: CONSTRUCTION_MODES.text, executionType: this.executionType })
      },

      _computeSelectedItem(items, index) {
        return items[index];
      }
    });

  </script>
</dom-module>
